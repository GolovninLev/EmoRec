<img src="https://i.ibb.co/G7cjkrK/2024-05-30-09-04-41.png" alt="EmoRec-Demo-2024-05-30" width="350" align="right"/>

## Общее описание проекта
Бот в телеграмме, которому можно прислать фото, видео или гиф-анимацию, на которой будет распознано выражения лиц людей в кадре.  
Приложение запускается посредством контейнера Docker, что позволяет ему быть независимым от операционной системы и её окружения.


## Настройки приложения

- В приложении предусмотрены следующие настройки:
  - Установка пользовательских изображений для отображения эмоций.
  - Изменение размера изображений для отображения эмоций.
  - Изменение прозрачности изображений для отображения эмоций.

- В приложении предусмотрено два вида получения результата:
  - В виде ответных сообщений телеграм-бота.
  - В виде загрузки файла на любой Google Диск после авторизации.

## Описание содержимого репозитория

- В папке models хранится модель для обнаружения лиц на изображении.
  - В эту папку следует поместить обученные веса модели VGG19.

- В папке emo_imgs хранятся изображения эмоций по умолчанию.

- В папке src хранятся исходники бота и модуля распознавания эмоций.

- В папке model_learner хранится скрипт для обучения модели распознавания эмоций.

- В папке papers хранятся статьи, связанные с проведёнными экспериментами по обучению моделей, использующихся в данном проекте. 



## Сборка и запуск в Docker-контейнере
1. Клонируйте данный репозиторий

2. Положите в католог `models` веса модели используемой для распознования эмоций в файле с именем `emo_rec_model.pth` (не помещаются в GitHub) 

3. Если вы планируете использвоать функцию отправки данных на гугл диск (любой), предоставте файлы `token.json` и `client_secrets.json`, которые можно получить из своего аккаунта Google Cloud Console (Google API)

4. Для сборки контейнера выполните следующую команду в папке с Docker-файлом (где `emo_rec` - имя создаваемого образа, а `0` - тег версии образа):

    ```sh
    cd EmoRec
    ```

    ```sh
    docker build -t emo_rec:0 .
    ```

5. Создайте токен и название бота, например, согласно [следующей инструкции](https://web7.pro/kak-poluchit-token-bota-telegram-api/)

6. Запуск контейнера с помощью команды (где флаг `-d` указывает на запуск контейнера в фоновом режиме) (не забудьте вставить своё значение токена телеграмм бота):

    ```sh
    docker run --rm -it -d -e TOKEN=<значение токена телеграмм бота> emo_rec:0
    ```

    или 

    ```sh
    docker run --rm -it -d --env-file /путь/к/файлу/.env emo_rec:0
    ```
    

6. После сборки и запуска проекта, становится доступен бот по ссылке: 
    
    ```link
    https://t.me/<название бота, которое вы ему дали при генерации своего токена>
    ```


